## Class `AMP_HTTP`

Class AMP_HTTP

### Methods
<details>
<summary>`send_header`</summary>

```php
static public send_header( $name, $value, $args = array() )
```

Send an HTTP response header.

This largely exists to facilitate unit testing but it also provides a better interface for sending headers.


</details>
<details>
<summary>`send_server_timing`</summary>

```php
static public send_server_timing( $name, $duration = null, $description = null )
```

Send Server-Timing header.

If WP_DEBUG is not enabled and an admin user (who can manage_options) is not logged-in, the Server-Header will not be sent.


</details>
<details>
<summary>`purge_amp_query_vars`</summary>

```php
static public purge_amp_query_vars()
```

Remove query vars that come in requests such as for amp-live-list.

WordPress should generally not respond differently to requests when these parameters are present. In some cases, when a query param such as __amp_source_origin is present then it would normally get included into pagination links generated by get_pagenum_link(). The validating sanitizer empties out links that contain this string as it matches the disallowed_value_regex. So by preemptively scrubbing any reference to these query vars we can ensure that WordPress won&#039;t end up referencing them in any way.


</details>
<details>
<summary>`filter_allowed_redirect_hosts`</summary>

```php
static public filter_allowed_redirect_hosts( $allowed_hosts )
```

Filter the allowed redirect hosts to include AMP caches.


</details>
<details>
<summary>`get_amp_cache_hosts`</summary>

```php
static public get_amp_cache_hosts()
```

Get list of AMP cache hosts (that is, CORS origins).


</details>
<details>
<summary>`send_cors_headers`</summary>

```php
static public send_cors_headers()
```

Send cors headers.

From the AMP docs: Restrict requests to source origins In all fetch requests, the AMP Runtime passes the &quot;__amp_source_origin&quot; query parameter, which contains the value of the source origin (for example, &quot;https://publisher1.com&quot;).
 To restrict requests to only source origins, check that the value of the &quot;__amp_source_origin&quot; parameter is within a set of the Publisher&#039;s own origins.
 Access-Control-Allow-Origin: &lt;origin&gt; This header is a W3 CORS Spec requirement, where origin refers to the requesting origin that was allowed via the CORS Origin request header (for example, &quot;https://&lt;publisher&#039;s subdomain&gt;.cdn.ampproject.org&quot;).
 Although the W3 CORS spec allows the value of * to be returned in the response, for improved security, you should:
 - If the Origin header is present, validate and echo the value of the Origin header. - If the Origin header isn&#039;t present, validate and echo the value of the &quot;__amp_source_origin&quot;.
 (Otherwise, no Access-Control-Allow-Origin header is sent.)
 AMP-Access-Control-Allow-Source-Origin: &lt;source-origin&gt; This header allows the specified source-origin to read the authorization response. The source-origin is the value specified and verified in the &quot;__amp_source_origin&quot; URL parameter (for example, &quot;https://publisher1.com&quot;).
 Access-Control-Expose-Headers: AMP-Access-Control-Allow-Source-Origin This header simply allows the CORS response to contain the AMP-Access-Control-Allow-Source-Origin header.


</details>
<details>
<summary>`handle_xhr_request`</summary>

```php
static public handle_xhr_request()
```

Hook into a POST form submissions, such as the comment form or some other form submission.


</details>
<details>
<summary>`intercept_post_request_redirect`</summary>

```php
static public intercept_post_request_redirect( $location )
```

Intercept the response to a POST request.


</details>
<details>
<summary>`handle_wp_die`</summary>

```php
static public handle_wp_die( $error, $title = '', $args = array() )
```

New error handler for AMP form submission.


</details>
<details>
<summary>`filter_comment_post_redirect`</summary>

```php
static public filter_comment_post_redirect( $url, $comment )
```

Handle comment_post_redirect to ensure page reload is done when comments_live_list is not supported, while sending back a success message when it is.


</details>
<details>
<summary>`get_response_content_type`</summary>

```php
static public get_response_content_type()
```

Get the Content-Type for the response.


</details>
